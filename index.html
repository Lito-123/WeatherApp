<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-200 p-5">

    <div id="app" class="max-w-md mx-auto bg-white p-5 rounded-md shadow-md">
        <h1 class="text-2xl font-bold text-center mb-5">Weather Forecast</h1>

        <!-- Form for entering the city -->
        <div class="mb-5">
            <input type="text" id="cityInput" class="p-2 border border-gray-300 rounded-md w-full" placeholder="Enter city name">
            <button id="getWeatherBtn" class="mt-3 p-2 w-full bg-blue-500 text-white rounded-md">Get Weather</button>
        </div>

        <!-- Weather Information -->
        <div id="weatherInfo" class="hidden">
            <h2 class="text-xl font-semibold mb-3" id="location"></h2>
            <p id="weatherDescription" class="mb-2"></p>
            <p id="temperature" class="text-xl font-bold"></p>
            <p id="cloudCover" class="text-sm mt-2"></p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden text-red-500 text-center mt-4"></div>
    </div>

    <script>
        // Select the DOM elements
        const getWeatherBtn = document.getElementById('getWeatherBtn');
        const cityInput = document.getElementById('cityInput');
        const weatherInfo = document.getElementById('weatherInfo');
        const location = document.getElementById('location');
        const weatherDescription = document.getElementById('weatherDescription');
        const temperature = document.getElementById('temperature');
        const cloudCover = document.getElementById('cloudCover');
        const errorMessage = document.getElementById('errorMessage');

        // Event listener for the Get Weather button
        getWeatherBtn.addEventListener('click', () => {
            const city = cityInput.value.trim();

            if (city === '') {
                displayError('Please enter a city name.');
                return;
            }

            fetchWeatherData(city);
        });

        // Function to fetch weather data from MetaWeather API
        async function fetchWeatherData(city) {
            // Clear previous data
            weatherInfo.classList.add('hidden');
            errorMessage.classList.add('hidden');

            // Get the WOEID (Where On Earth ID) for the city
            try {
                const response = await fetch(`https://www.metaweather.com/api/location/search/?query=${city}`);
                const data = await response.json();

                if (data.length === 0) {
                    displayError('City not found.');
                    return;
                }

                const locationData = data[0];
                const woeid = locationData.woeid;

                // Fetch weather forecast for the found city
                const weatherResponse = await fetch(`https://www.metaweather.com/api/location/${woeid}/`);
                const weatherData = await weatherResponse.json();

                displayWeatherData(weatherData);
            } catch (error) {
                displayError('Failed to fetch weather data.');
            }
        }

        // Function to display weather data
        function displayWeatherData(weatherData) {
            const weatherToday = weatherData.consolidated_weather[0]; // Get today's weather
            const city = weatherData.title;
            const description = weatherToday.weather_state_name;
            const temp = weatherToday.the_temp.toFixed(1); // Current temperature
            const cloud = weatherToday.clouds; // Cloud coverage percentage

            location.textContent = city;
            weatherDescription.textContent = description;
            temperature.textContent = `${temp}Â°C`;
            cloudCover.textContent = `Cloud Cover: ${cloud}%`;

            weatherInfo.classList.remove('hidden');
        }

        // Function to display error message
        function displayError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
        }
    </script>

</body>

</html>
